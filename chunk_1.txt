MNRAS 000, 1‚Äì27 (2024) Preprint 22 November 2024 Compiled using MNRAS L ATEX style file v3.0 Learning the Universe: Cosmological and Astrophysical Parameter Inference with Galaxy Luminosity Functions and Colours Christopher C. Lovell,1‚òÖTjitske Starkenburg2,3,4, Matthew Ho,5Daniel Angl√©s-Alc√°zar,6 Romeel Dav√©,7,8,9Austen Gabrielpillai,10Kartheik G. Iyer,5Alice E. Matthews,11William J. Roper,12 Rachel S. Somerville,13Laura Sommovigo,13Francisco Villaescusa-Navarro13,14 1Institute of Cosmology and Gravitation, University of Portsmouth, Burnaby Road, Portsmouth, PO1 3FX, UK 2Center for Interdisciplinary Exploration and Research in Astrophysics (CIERA), Northwestern University, 1800 Sherman Ave, Evanston IL 60201, USA 3Department of Physics and Astronomy, Northwestern University, 2145 Sheridan Rd, Evanston IL 60208, USA 4NSF-Simons AI Institute for the Sky (SkAI), 172 E. Chestnut St., Chicago, IL 60611, USA 5Columbia Astrophysics Laboratory, Columbia University, 550 West 120th Street, New York, NY 10027, USA 6Department of Physics, University of Connecticut, 196 Auditorium Road, U-3046, Storrs, CT 06269-3046, USA 7Institute for Astronomy, Royal Observatory, University of Edinburgh, Edinburgh EH9 3HJ, UK 8University of the Western Cape, Department of Physics and Astronomy, Bellville, Cape Town 7535, South Africa 9South African Astronomical Observatories, Observatory, Cape Town 7925, South Africa 10Department of Astrophysics, The Graduate Center, City University of New York, 365 5th Ave, New York, NY 10016, USA 11Mullard Space Science Laboratory, University College London, Holmbury St Mary, Dorking, Surrey, RH5 6NT, UK 12Astronomy Centre, University of Sussex, Falmer, Brighton BN1 9QH, UK 13Center for Computational Astrophysics, Flatiron Institute, 162 Fifth Avenue, New York, NY, 10010, USA 14Departent of Astrophysical Sciences, Princeton University, Princeton NJ 08544, USA Accepted XXX. Received YYY; in original form ZZZ ABSTRACT We perform the first direct cosmological and astrophysical parameter inference from the combination of galaxy luminosity functionsandcoloursusingasimulationbasedinferenceapproach.Usingthe Synthesizer codewesimulatethedustattenuated ultraviolet‚Äìnear infrared stellar emission from galaxies in thousands of cosmological hydrodynamic simulations from the CAMELS suite, including the Swift-EAGLE ,Illustris-TNG ,Simba&Astridgalaxy formation models. For each galaxy we calculate the rest-frame luminosity in a number of photometric bands, including the SDSS ugrizand GALEX FUV & NUV filters;thisdatasetrepresentsthelargestcatalogueofsyntheticphotometrybasedonhydrodynamicgalaxyformationsimulations produced to date, totalling >200 million sources. From these we compile luminosity functions and colour distributions, and find clear dependencies on both cosmology and feedback. We then perform simulation based (likelihood-free) inference using these distributions, and obtain constraints on both cosmological and astrophysical parameters. Both colour distributions and luminosity functions provide complementary information on certain parameters when performing inference. Most interestingly weachieveconstraintson ùúé8,describingtheclusteringofmatter.Thisisattributabletothefactthatthephotometryencodesthe star formation‚Äìmetal enrichment history of each galaxy; galaxies in a universe with a higher ùúé8tend to form earlier and have highermetallicities,whichleadstoreddercolours.Wefindthatamodeltrainedononegalaxyformationsimulationgeneralises poorlywhenappliedtoanother,andattributethistodifferencesinthesubgridprescriptions,andlackofflexibilityinouremission modelling. The photometric catalogues are publicly available at: https://camels.readthedocs.io/ . Key words: galaxies: abundances ‚Äì galaxies: photometry ‚Äì cosmology: cosmological parameters 1 INTRODUCTION Machine learning methods, particularly deep learning algorithms, are now capable of learning both deterministic and probabilistic re- lationships with a high degree of flexibility, and have achieved wide use within the fields of cosmology and astrophysics (Carleo et al. 2019;?; Smith & Geach 2023). One particularly powerful applica- ‚òÖE-mail: christopher.lovell@port.ac.uk (CCL)tionofthesemethodsisinBayesianinference,whereinoneestimates theparametersofamodelgivensomeassumedpriorhypothesisand observed data ( e.g.Christensen et al. 2001). This combination of machine learning and Bayesian inference is known as Simulation Based Inference (SBI, also called implicit likelihood inference, or likelihood-freeinference;seeMarinetal.2012;Cranmeretal.2020), a rigorous Bayesian approach to learning the relationship between simulated data ( X) and the underlying parameters used to generate it (ùúÉ), typically leveraging flexible neural density estimators (NDEs, ¬©2024 The AuthorsarXiv:2411.13960v1 [astro-ph.GA] 21 Nov 20242 C. C. Lovell et al. e.g. Durkan et al. 2019). In contrast with traditional Bayesian meth- ods,ananalyticformofthelikelihooddoesnotneedtobeprovided; instead, an SBI approach directly learns the form of the likelihood. This provides many advantages, particularly in instances where the likelihoodisnon-Gaussian(suchaswhensystematicsareconsidered; Jeffrey et al. 2021), or intractable (such as in field‚Äìlevel inference; Leclercq & Heavens 2021; Lemos et al. 2023). They also permit amortizedinference,wherebythefullposteriorcanbeevaluatedand sampledrapidlyatthepointofinference,reducingthecomputational cost;thisopensupnewavenuesforBayesianparameterinferenceon extremely large datasets (Ho et al. 2024). A number of studies have used SBI to perform cosmological pa- rameter inference. These exploit simulations that explicitly model the relationship between cosmological parameters and observable statistics, such as the cosmic microwave background power spec- trum(e.g.Lemosetal.2023),orclusteringstatisticsinthepresence of weak-lensing effects (e.g. von Wietersheim-Kramsta et al. 2024). Thesesimulationscoverawiderangeofsophistication,fromanalyt- ical descriptions of the distribution of halo properties (Mead et al. 2021; Tessore et al. 2023) to full ùëÅ-body simulations of the large scalestructure(Villaescusa-Navarroetal.2020).Analyticorempir- ical models are often then applied to map galaxies or observational tracerstotheunderlyingmatterdensity.However,thesesimplemod- els relating dark matter properties to observational tracers are often inadequate (Hadzhiyska et al. 2020), and at small scales astrophys- ical effects, such as energetic feedback from active galactic nuclei (AGN)andstarformation,canimpacttheoverallmatterdistribution (Angl√©s-Alc√°zaretal.2017;Borrowetal.2020;Delgadoetal.2023; Tillmanetal.2023;Gebhardtetal.2024),requiringmodificationsto ùëÅ-body predictions (Bose et al. 2021; Carrilho et al. 2022; Schaller etal.2024a).Toovercometheselimitationsrequiressimulatingthese processes explicitly. State-of-the-arthydrodynamicsimulationsarenowcapableofpro- ducing realistic galaxy samples in large volumes that match a num- berofkeydistributionfunctionsinthelocalUniverse(Somerville& Dav√© 2015; Vogelsberger et al. 2020; Crain & van de Voort 2023). Thesesimulationsself-consistentlymodeltheevolutionofcollision- less dark matter as well as baryons down to some resolution limit, beyond which subgrid models are used to approximate the impact of sub-resolution physical processes on the macro-scale properties of galaxies. Such simulations can be used in an SBI framework not onlytounderstandtheimpactofbaryonsandastrophysicalprocesses on cosmological parameter inference, but also to perform inference directly on astrophysical parameters of interest. However, hydrody- namicsimulationsareexceedinglycomputationallyexpensive,limit- ingthevolume,resolutionand/orphysicalfidelityofthesimulations thatcanberun.Beyondthechallengesinherentinrunningthesimu- lations,theyarealsocomputationallychallengingforuseinSBIdue to the range of parameters that can be varied, and the large volume of data products that must be computed and stored. Despitetheseobstaclestherehasbeenrecentprogressinproducing hydrodynamicsimulationsuitesthatareamenabletoSBIapproaches. The Cosmology and Astrophysics with MachinE-Learning Simula- tions (CAMELS; Villaescusa-Navarro et al. 2021b) project brought together a number of hydrodynamic and semi-analytic galaxy for- mation models, each consisting of large suites of simulations vary- ing both cosmological and astrophysical paramaters that have been usedinanSBIframeworkforparameterinference( e.g.Villaescusa- Navarro et al. 2021a, 2022; Nicola et al. 2022; Hassan et al. 2022; Friedman&Hassan2022;Thieleetal.2022;Villanueva-Domingo& Villaescusa-Navarro 2022; Shao et al. 2022; de Santi et al. 2023b,a; Perez et al. 2023; Jo et al. 2023; Echeverri-Rojas et al. 2023).The majority of these studies have performed inference on intrin- sic properties of galaxies (or physical fields). However, in order to make a like-for-like comparison with observations we must forward model theelectromagnetic emission fromgalaxies, andcompare di- rectlyinthisobserverspace(Fortunietal.2023).Thereareanumber of approaches for achieving this, but almost all start by modelling the stellar emission using stellar population synthesis (SPS) models (Conroy 2013) coupled to