thermal mode; 𝐴AGN1controls the efficiency scaling of the Bondi accretion rate, and 𝐴AGN2the temperature jump of the gas during AGN feedback events. Neither parameter has a large effect on the optical LFs, but there is a small difference in the bright end in the UV, whereby increasing both parameters reduces the abun- danceofUVbrightgalaxies.Thedifferencesinthecoloursaremore pronounced; increasing both parameters lead to redder UV and op- tical colours. This suggests that increasing the primary efficacy of thermal feedback in Swift-EAGLE does not lead to the same self- regulation effects seen in Astrid, and had a more predictable effect on the luminosities and colours of massive, bright galaxies hosting AGN. MNRAS 000, 1–27 (2024)LtU: Parameter inference on photometry 13 Figure 8. The same as Figure 5, but showing the variation in the 𝐴SN11P set. MNRAS 000, 1–27 (2024)14 C. C. Lovell et al. Figure 9. The same as Figure 5, but showing the variation in the 𝐴SN21P set. MNRAS 000, 1–27 (2024)LtU: Parameter inference on photometry 15 Figure 10. The same as Figure 5, but showing the variation in the 𝐴AGN11P set. MNRAS 000, 1–27 (2024)16 C. C. Lovell et al. Figure 11. The same as Figure 5, but showing the variation in the 𝐴AGN21P set. MNRAS 000, 1–27 (2024)LtU: Parameter inference on photometry 17 5 SIMULATION BASED INFERENCE WITH LTU-ILI We now explore the use of our forward modelled UV-optical lumi- nosity and colour distributions from the CAMELS LH set within an SBI framework. SBI is a powerful framework for performing in- ference in this domain since it permits amortized posteriors, which significantly speeds up the process of obtaining posteriors. This al- lowsustoapplythetrainedmodeltohundredsoftestsetsimulations in just fractions of a second. Additionally, SBI does not require an explicitlikelihood,whichpermitustousemorecomplexnoisemod- els, which we will explore in future work when comparing directly to observations. 5.1 SBI Architecture WeusetheLtU-ILIpackage(Hoetal.2024)toperformSBI.LtU-ILI isacodebasethatsimplifiesmanyofthestepsinanSBIanalysis,par- ticularly those concerning testing and validation such as estimating the epistemic uncertainty, choosing hyperparameters, and assessing modelmisspecification.Weusethe sbipackagewithinLtU-ILI,and perform neural posterior estimation (NPE; Papamakarios & Murray 2016;Greenbergetal.2019),toallowamortizedinference.Wecon- structanensembleoftwomodels,eachcomposedofaneuralspline flow (Durkan et al. 2019) with 4 transforms, 10 spline bins, and 60 hidden features. During training we use a batch size of 4, and a fixed learning rate of 5×10−4, and an improvement based stopping criterion. Throughout the rest of this manuscript we will present models trained and applied to different simulations. We use the same ar- chitecture for each trained model. For each simulation we reserve a subset of the LH simulations as a test set (10%), and a further subset of the remaining simulations for validation (10%). The re- maining simulations we use for training, and evaluate our model performance during training on the validation set. Our priors are set bythechosendistributionoftheparametersintheLHset,described inVillaescusa-Navarroetal.(2021b).Aftertraining,toproducepos- teriors for a given set of parameters we directly take 1000 samples from the NPE. For our input data we choose a subset of attenuated luminosity functions (in the GALEX 𝐹𝑈𝑉and𝑁𝑈𝑉bands, and the SDSS 𝑢𝑔𝑟𝑖𝑧bands) and colour distributions ( 𝐹𝑈𝑉−𝑁𝑈𝑉,𝑔−𝑟,𝑟−𝑖, 𝑖−𝑧).Foreachluminosityfunctionweapply12binslinearlyspaced between bright- and faint–end AB magnitude limits given in Ta- ble2.Forcolourdistributions,wealsoapply12binslinearlyspaced between the red- and blue–limits given in Table 3. We provide the observational data as a single one-dimensional concatenated vector, X;wheremultipleredshiftsareconsideredthesearesimplyconcate- nated together. We perform coverage tests for each trained model, discussed in Appendix B. In the following sections we will explore how our results depend on the choice of luminosity functions or colours, and how combining distributions at different redshifts can improve constraints on key cosmological and astrophysical parame- ters. 5.2 Inference We begin by showing the predicted marginal posteriors on our cos- mological and astrophysical parameters for all test set simulations, usingamodeltrainedandtestedonthesamegalaxyformationmodel, inFigures12&13.Weshowposteriorpredictionsfor Ωm,𝜎8,𝐴SN1, 𝐴SN2,𝐴AGN1and𝐴AGN2against their true values, for Illustris- TNG,Simba,Swift-EAGLE andAstrid. As input data we provideTable 2. Bright- and faint–end AB magnitude limits chosen for luminosity functions used in the SBI analysis. Band Bright limit Faint limit FUV -20.5 -15 NUV -20.5 -15 u -21.5 -16 g -22.5 -17 r -23.5 -18 i -24 -18.5 z -24.5 -19 Table3.Blue-andred–limitingcolourschosenfortheconstructionofcolour distributions used in the SBI analysis. Colour Bright limit Faint limit 𝐹𝑈𝑉–𝑁𝑈𝑉 -0.5 3.5 𝑔–𝑟 0.0 1.0 𝑟–𝑖 0.0 0.5 𝑖–𝑧 -0.1 0.4 all luminosity functions and colour distributions described in Sec- tion 5.1 at a single redshift, 𝑧=0.1. We also calculate a number of statistics describing the goodness of fit, including the Root Mean Squared Error (RMSE), RMSE=vut 1 𝑁𝑁∑︁ 𝑖=1(𝜃𝑖−𝜇𝑖)2, (8) and the mean relative error, 𝜖=1 𝑁𝑁∑︁ 𝑖=1|𝜃𝑖−𝜇𝑖| 𝜇𝑖, (9) whichbothmeasurethe precision oftheestimate(lowervaluesbeing more precise). We also calculate the coefficient of determination, 𝑅2=1−Í𝑁 𝑖=1(𝜃𝑖−𝜇𝑖)2 Í𝑁 𝑖=1(𝜃𝑖−ˆ𝜃𝑖)2, (10) whichmeasuresthe accuracy oftheestimate(valuescloseto1being more accurate), and the reduced chi-squared, 𝜒2=1 𝑁𝑁∑︁ 𝑖=1(𝜃𝑖−𝜇𝑖) 𝜎𝑖2 , (11) which measures the accuracy of the estimated posterior uncertain- ties; values close to 1 indicate that the magnitude of the errors (ap- proximatedbythemarginalstandarddeviation 𝜎)hasbeenestimated correctly, whereas values above / below 1 indicate an under- / over- predictionoftheerror.Forallgalaxyformationmodelsandparame- ters (except for a couple of exceptions discussed below) the reduced chi-squared value lies between 0.76 and 1.55, which indicates that all errors are well estimated. TherearesomeclearlyvisibletrendsinFigures12&13. Ωmispre- dicted precisely andaccurately across all simulations, witha RMSE of0.03and𝑅2of0.93inSwift-EAGLE,thoughslightlylesswellin Astrid(RMSE=0.07, 𝑅2=0.63).Thisagreeswellwiththelargevari- ationsintheLFsandcolourdistributionsasafunctionof Ωmseenin Section 4.2.1. The value of 𝜎8is also predicted, somewhat surpris- ingly;allwehaveprovidedasobserveddataareluminosityfunctions andcolourdistributions,whichdonotincludeanyexplicitspatialin- formationfromwhichtoderiveclusteringconstraints.Theprecision and accuracy strongly depend on the galaxy formation model, with thebestprecisionandaccuracyfoundinIllustris-TNG(RMSE=0.05, MNRAS 000, 1–27 (2024)18 C. C. Lovell et al. Figure 12. Predicted marginal posteriors on the test set vs the true values for each cosmological ( Ωm,𝜎8) and astrophysical ( 𝐴SN1,𝐴SN2,𝐴AGN1,𝐴AGN2) parameter. These estimates use both colours and luminosity functions at 𝑧=0.1, described in more detail in Section 5.2, using training and testing data from the same galaxy formation model; we discuss generalisability across different models in Section 5.4. Top two rows : Swift-EAGLE. Bottom two rows : Astrid. MNRAS 000, 1–27 (2024)LtU: Parameter inference on photometry 19 Figure 13. The same as Figure 12, but showing predictions for Illustris-TNG (top two rows) and Simba(bottom two rows). MNRAS 000, 1–27 (2024)20 C. C. Lovell et al. 𝑅2=0.81), and the worst of both in Astrid (RMSE=0.09, 𝑅2=0.38). Thissuggeststhatspecificsofthegalaxyformationmodelaffecthow 𝜎8impactsthepopulationgalaxyemission,asseeninSection4.2.2, highlighting the importance of taking into account such specifics when marginalising over astrophysics in a cosmological analyses